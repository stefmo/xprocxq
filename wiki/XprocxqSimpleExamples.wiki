#summary One-sentence summary of this page.

= Introduction =

These examples have been tested against xprocxq.

*note*: the links after each example will run your local eXist copy of /examples which you must upload to eXist.

== p:identity Hello World =

{{{

xquery version "1.0" encoding "UTF-8";

import module namespace const = "http://xproc.net/xproc/const";
import module namespace xproc = "http://xproc.net/xproc";
import module namespace u = "http://xproc.net/xproc/util";

declare variable $local:XPROCXQ_EXAMPLES := "/db/examples";   (: CHANGE ME :)

let $stdin :=document{<test>Hello World</test>}

let $pipeline :=document{
                    <p:pipeline name="pipeline"
                                xmlns:p="http://www.w3.org/ns/xproc"
                                xmlns:c="http://www.w3.org/ns/xproc-step">
                        <p:identity/>
                    </p:pipeline>
                }

return
     xproc:run($pipeline,$stdin) 


}}}

[http://127.0.0.1:8080/exist/rest/examples/helloworld.xq helloworld.xq]

== p:xslt ==

{{{

}}}
[http://127.0.0.1:8080/exist/rest/examples/step_examples/pxslt.xq pxslt.xq]

== p:xquery ==

{{{

}}}
[http://127.0.0.1:8080/exist/rest/examples/step_examples/pxslt.xq pxquery.xq]

== p:store ==

p:store can save document to eXist XML Database. To run this example you will have to allow write permissions for XQuery to generate storetest.xml to /db/examples/result collection, otherwise you will get an error.

{{{
xquery version "1.0" encoding "UTF-8";

import module namespace const = "http://xproc.net/xproc/const";
import module namespace xproc = "http://xproc.net/xproc";
import module namespace u = "http://xproc.net/xproc/util";

declare variable $local:XPROCXQ_EXAMPLES := "/db/examples";   (: CHANGE ME :)

let $stdin :=document{<test/>}

let $pipeline :=document{
                    <p:pipeline name="pipeline"
                                xmlns:p="http://www.w3.org/ns/xproc"
                                xmlns:c="http://www.w3.org/ns/xproc-step">
                        <p:store href="{$local:XPROCXQ_EXAMPLES}/result/storetest.xml"/>
                    </p:pipeline>
                }

return
     xproc:run($pipeline,$stdin) 


}}}
[http://127.0.0.1:8080/exist/rest/examples/step_examples/pstore.xq pstore.xq]

*note*: no support for file: and http: at this time

== p:choose ==

{{{

}}}
[http://127.0.0.1:8080/exist/rest/examples/step_examples/pchoose.xq pchoose.xq]

== p:escape-markup / p:unescape-markup ==

{{{

}}}
[http://127.0.0.1:8080/exist/rest/examples/step_examples/pescapemarkup.xq pescapemarkup.xq]

== p:xsl-formatter ==

This example takes 

{{{
xquery version "1.0" encoding "UTF-8";

import module namespace const = "http://xproc.net/xproc/const";
import module namespace xproc = "http://xproc.net/xproc";
import module namespace naming = "http://xproc.net/xproc/naming";
import module namespace u = "http://xproc.net/xproc/util";

import module namespace xslfo = "http://exist-db.org/xquery/xslfo"; (: required for p:xsl-formatter :)

declare variable $local:XPROCXQ_EXAMPLES := "/db/examples";   (: CHANGE ME :)

let $stdin :=doc('/db/xqdocs/index.xml')//body             (: need eXist index page as example :)
  
let $pipeline :=document{<p:pipeline name="pipeline"
            xmlns:p="http://www.w3.org/ns/xproc">

<p:xslt>                                         
   <p:input port="stylesheet">
       <p:document href="{$local:XPROCXQ_EXAMPLES}/existdoc2pdf.xsl"/>
   </p:input>
</p:xslt>
<p:xsl-formatter href='{XPROCXQ_EXAMPLES}/result/existdocs.pdf'/>

</p:pipeline>}

return
    xproc:run($pipeline,$stdin)
        
        
}}}

[http://127.0.0.1:8080/exist/rest/examples/step_examples/pxslformatter.xq pxslformatter.xq]